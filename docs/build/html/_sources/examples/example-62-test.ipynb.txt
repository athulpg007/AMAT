{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "7d3bbaeb",
   "metadata": {},
   "source": [
    "# Example - 62 - test"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "111bf35d",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "846576c6",
   "metadata": {},
   "source": [
    "<font color='red'>**Note**:</font> This examples requires ```astropy``` and ```poliastro``` to be installed. These are not installed by default when AMAT is installed and must be installed separately using ```pip install astropy``` and ```pip install poliastro```. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "a5116f83",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Notebook initialized with ipy backend.\n"
     ]
    }
   ],
   "source": [
    "from mayavi import mlab\n",
    "mlab.init_notebook(backend='ipy')\n",
    "\n",
    "import numpy as np\n",
    "\n",
    "from AMAT.approach import Approach"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "843a66de",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9380e110e6464836be35e5dec6b9e309",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Image(value=b'\\x89PNG\\r\\n\\x1a\\n\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x04\\xb0\\x00\\x00\\x03 \\x08\\x02\\x00\\x00\\x00\\xbc\\x82\\x0câ€¦"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "probe1 = Approach(\"NEPTUNE\",\n",
    "                    v_inf_vec_icrf_kms=np.array([17.78952518, 8.62038536, 3.15801163]),\n",
    "                    rp=(24764 + 400) * 1e3, psi=np.pi,\n",
    "                    is_entrySystem=True, h_EI=1000e3)\n",
    "\n",
    "\n",
    "probe2 = Approach(\"NEPTUNE\",\n",
    "                    v_inf_vec_icrf_kms=np.array([17.78952518, 8.62038536, 3.15801163]),\n",
    "                    rp=(24764 + 400) * 1e3, psi=3* np.pi/2,\n",
    "                    is_entrySystem=True, h_EI=1000e3)\n",
    "\n",
    "theta_star_arr_probe1 = np.linspace(-1.8, probe1.theta_star_entry, 101)\n",
    "pos_vec_bi_arr_probe1 = probe1.pos_vec_bi(theta_star_arr_probe1)/24764e3\n",
    "\n",
    "\n",
    "theta_star_arr_probe2 = np.linspace(-1.8, probe2.theta_star_entry, 101)\n",
    "pos_vec_bi_arr_probe2 = probe2.pos_vec_bi(theta_star_arr_probe2)/24764e3\n",
    "\n",
    "x_arr_probe1 = pos_vec_bi_arr_probe1[0][:]\n",
    "y_arr_probe1 = pos_vec_bi_arr_probe1[1][:]\n",
    "z_arr_probe1 = pos_vec_bi_arr_probe1[2][:]\n",
    "\n",
    "x_arr_probe2 = pos_vec_bi_arr_probe2[0][:]\n",
    "y_arr_probe2 = pos_vec_bi_arr_probe2[1][:]\n",
    "z_arr_probe2 = pos_vec_bi_arr_probe2[2][:]\n",
    "\n",
    "\n",
    "u = np.linspace(0, 2 * np.pi, 100)\n",
    "v = np.linspace(0, np.pi, 100)\n",
    "x = 1*np.outer(np.cos(u), np.sin(v))\n",
    "y = 1*np.outer(np.sin(u), np.sin(v))\n",
    "z = 1*np.outer(np.ones(np.size(u)), np.cos(v))\n",
    "\n",
    "x1 = 1.040381198513972*np.outer(np.cos(u), np.sin(v))\n",
    "y1 = 1.040381198513972*np.outer(np.sin(u), np.sin(v))\n",
    "z1 = 1.040381198513972*np.outer(np.ones(np.size(u)), np.cos(v))\n",
    "\n",
    "\n",
    "x_ring_1 = 1.1*np.cos(u)\n",
    "y_ring_1 = 1.1*np.sin(u)\n",
    "z_ring_1 = 0.0*np.cos(u)\n",
    "\n",
    "x_ring_2 = 1.2*np.cos(u)\n",
    "y_ring_2 = 1.2*np.sin(u)\n",
    "z_ring_2 = 0.0*np.cos(u)\n",
    "\n",
    "mlab.figure(bgcolor=(0,0,0), size=(1200,800))\n",
    "s1 = mlab.mesh(x, y, z, color=(0,0,1))\n",
    "s2 = mlab.mesh(x1, y1, z1, color=(0,0,1), opacity=0.3)\n",
    "r1 = mlab.plot3d(x_ring_1, y_ring_1, z_ring_1, color=(1,1,1), line_width=1, tube_radius=None)\n",
    "r2 = mlab.plot3d(x_ring_2, y_ring_2, z_ring_2, color=(1,1,1), line_width=1, tube_radius=None)\n",
    "\n",
    "p1 = mlab.plot3d(x_arr_probe1, y_arr_probe1, z_arr_probe1, color=(1,0,0), line_width=3, tube_radius=None)\n",
    "p2 = mlab.plot3d(x_arr_probe2, y_arr_probe2, z_arr_probe2, color=(0,1,0), line_width=3, tube_radius=None)\n",
    "\n",
    "\n",
    "mlab.show()\n",
    "p2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82a09f02",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
